<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>ICMP Socket & Raw Socket Fragmentation — ns-3</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <!-- Materialize CSS (similar look & feel to the reference page) -->
  <link href="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/css/materialize.min.css" rel="stylesheet">
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">
  <style>
    :root {
      --primary: #1565c0;
      --primary-dark: #0d47a1;
      --accent: #26a69a;
    }
    nav { background: var(--primary); }
    .brand-logo { font-weight: 700; letter-spacing: .3px; }
    .hero {
      background: linear-gradient(135deg, var(--primary) 0%, var(--primary-dark) 100%);
      color: #fff;
      padding: 64px 0 40px;
    }
    .chip.em { background: rgba(255,255,255,.15); color: #fff; border: 1px solid rgba(255,255,255,.3); }
    .section-title { margin: 0 0 8px; font-weight: 700; }
    .subtle { color: #607d8b; }
    .card .card-title { font-weight: 700; }
    .mr-link { font-weight: 600; }
    .icon-bullet { vertical-align: middle; margin-right: 6px; }
    footer.page-footer { background: #0f3460; }
    .kbd {
      font-family: ui-monospace, SFMono-Regular, Menlo, Monaco, Consolas, "Liberation Mono", "Courier New", monospace;
      background: #eceff1; border-radius: 6px; padding: 2px 6px; font-size: .9rem;
    }
    .collapsible-header { font-weight: 600; }
    .list-tight li { margin-bottom: 6px; }
  </style>
</head>
<body>

  <!-- Nav -->
  <nav>
    <div class="nav-wrapper container">
      <a href="#" class="brand-logo">ns-3: ICMP Socket </a>
      <a href="#" data-target="nav-mobile" class="sidenav-trigger"><i class="material-icons">menu</i></a>
      <ul id="nav" class="right hide-on-med-and-down">
        <li><a href="#overview">Overview</a></li>
        <li><a href="#milestones">Milestones</a></li>
        <li><a href="#limitations">Limitations</a></li>
        <li><a href="#problem">Design Note</a></li>
        <li><a href="#links">Links</a></li>
      </ul>
    </div>
  </nav>
  <ul class="sidenav" id="nav-mobile">
    <li><a href="#overview">Overview</a></li>
    <li><a href="#milestones">Milestones</a></li>
    <li><a href="#limitations">Limitations</a></li>
    <li><a href="#problem">Design Note</a></li>
    <li><a href="#links">Links</a></li>
  </ul>

  <!-- Title Section -->
  <div class="container" style="margin-top:40px; margin-bottom:20px;">
    <h4>Implementation of ICMP socket in ns-3</h4>
    <p>
  ns-3 currently lacks a dedicated socket for handling ICMP packets. Users are forced to rely on raw sockets, which do not provide dedicated support for ICMP packets. Thus, the users have to implement the handling of ICMP packets, filtering of them, etc. in the application. This project aims to offload this functionality to a dedicated ICMP socket similar to SOCK_DGRAM of Linux. 
</p>
  <div class="chips" style="margin-top:10px; margin-bottom: 20px;">
    <div class="chip"><i class="material-icons left">person</i>Student: Aditya Ruhela</div>
    <div class="chip"><i class="material-icons left">supervisor_account</i>Mentors: Tommaso Pecorella &amp; Alberto Gallegos</div>
  </div>
    <hr />
  </div>

  <!-- Overview -->
  <section id="overview" class="section">
    <div class="container">
      <h5 class="section-title">Project Overview</h5>
        <p>
        ns-3 is a powerful discrete-event simulator that is widely used in research for network analysis. 
        While it supports a broad range of protocols and topologies, it has a notable shortcoming: there is no dedicated 
        socket for handling ICMP packets. At present, users must rely on raw sockets to send ICMP messages, which is 
        problematic because raw sockets don’t fully support ICMP features such as echo message handling, error reporting, 
        and fragmented packet reassembly.
        </p>

        <p>
        Without a dedicated ICMP socket, ns-3 cannot accurately mimic real-world network behavior. This reduces the 
        fidelity of simulations, especially in scenarios or applications that rely on ICMP, such as diagnostic tools 
        (<strong>ping</strong>, <strong>traceroute</strong>), path MTU discovery, dynamic routing, and network performance monitoring. 
        Implementing an ICMP socket bridges this gap and allows ns-3 to simulate these functions robustly.
        </p>

        <h5>Significance</h5>

        <p>
        Consider TCP: if ns-3 didn’t have a TCP socket, users would be forced to implement connection management, flow 
        control, error handling, and congestion avoidance on their own using raw sockets. This would be tedious and 
        error-prone. Similarly, without an ICMP socket, users must manually implement header handling, filtering, etc.
        </p>

        <p>
        Applications and protocols that benefit directly from a dedicated ICMP socket include:
        </p>
        <ul class="browser-default">
        <li><strong>Ping:</strong> Uses ICMP packets to verify connectivity between hosts.</li>
        <li><strong>Traceroute:</strong> Sends ICMP packets to determine the path between hosts.</li>
        <li><strong>Path MTU Discovery:</strong> Relies on ICMP “Fragmentation Needed” messages to discover the maximum transmission unit.</li>
        <li><strong>Neighbor Discovery Protocol (NDP):</strong> ICMPv6 messages (RS, RA, NS, NA) enable dynamic communication in IPv6 networks.</li>
        </ul>

        <p>
        By implementing a dedicated ICMP socket, this project simplifies the user experience, enhances simulation 
        accuracy, and eliminates the need for repetitive, error-prone reimplementation of ICMP functionality.
        </p>

    </div>
  </section>

  <!-- Milestones -->
  <section id="milestones" class="section">
    <div class="container">
      <h5 class="section-title">Milestones</h5>

      <!-- Phase 1 Card -->
      <div class="card">
        <div class="card-content">
          <span class="card-title">Phase 1: Fix the fragmentation issue in Raw sockets</span>
          <p class="subtle" style="margin-top:6px;">
            <i class="material-icons icon-bullet">link</i>
            <a class="mr-link" href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests/2486" target="_blank" rel="noopener">Merge Request #2486</a>
          </p>
          <ul class="browser-default list-tight" style="margin-top:12px;">
            <li><strong>Forward assembled packets:</strong> In case of raw sockets, forward the packet up to the application <em>after</em> the re-assembly, not before that (existing implementation).</li>
            <li><strong>Test cases:</strong> Wrote the test case for IPv4 and IPv6 Raw sockets that ensure that only a single assembled packet is received. Also included the test cases for Ping application with fragmentation.</li>
          </ul>
        </div>
      </div>

      <!-- Phase 2 Card -->
      <div class="card">
        <div class="card-content">
          <span class="card-title">Phase 2: Implementation of the ICMP socket</span>
          <p class="subtle" style="margin-top:6px;">
            <i class="material-icons icon-bullet">link</i>
            <a class="mr-link" href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests/2527" target="_blank" rel="noopener">Merge Request #2527</a>
          </p>

          <h6 style="margin-top:12px;">Changes</h6>
          <ul class="browser-default list-tight">
            <li><strong>ICMP error messages:</strong> Integrated support for sending ICMP Destination Unreachable messages from the IP layer upon packet drop.</li>
            <li><strong>ICMP socket:</strong> Implemented a dedicated ICMP socket, the LLD of which is similar to that of the UDP socket.</li>
          </ul>

          <h6 style="margin-top:12px;">Features</h6>
          <ul class="browser-default list-tight">
            <li><strong>ICMP handling:</strong> Processing of ICMP headers is completely offloaded from the application. The new socket does not send the ICMP header to the application (unlike raw sockets); instead, it uses <span class="kbd">IcmpPacketInfoTag</span>.</li>
            <li><strong>New Packet Tag:</strong> Introduced <span class="kbd">IcmpPacketInfoTag</span> that stores metadata about the received ICMP packet to be sent up to the application.</li>
          </ul>

          <h6 style="margin-top:12px;">Tests & Integration</h6>
          <ul class="browser-default list-tight">
            <li><strong>Tests:</strong> Added unit tests for validating ICMP functionality covering almost all ICMP types for received packets (echo reply, destination unreachable, time exceeded, etc.).</li>
            <li><strong>Ping application:</strong> Integrated the novel ICMP socket in the Ping application. Users can choose to send packets via ICMP socket or via Raw Sockets.</li>
          </ul>
        </div>
      </div>
    </div>
  </section>

  <!-- Limitations -->
  <section id="limitations" class="section">
    <div class="container">
      <h5 class="section-title">Limitations & Proposed Solutions</h5>
      <ul class="collapsible popout">
        <li>
          <div class="collapsible-header"><i class="material-icons">loop</i>SO_REUSEADDR behavior</div>
          <div class="collapsible-body">
            <p>
              The novel ICMP socket does not allow two sockets on the same node to be bound to the same identifier even if they are bound to different IP addresses. This can be solved by using a
              <span class="kbd">map(identifier → List&lt;ICMP socket&gt;)</span> instead of the current
              <span class="kbd">map(identifier → ICMP socket)</span>.
            </p>
          </div>
        </li>
        <li>
          <div class="collapsible-header"><i class="material-icons">account_tree</i>Identifier map in protocol layer</div>
          <div class="collapsible-body">
            <p>
              The current LLD stores the map of used identifiers in the protocol layer, which pollutes the ICMP protocol. A cleaner approach is to store an <span class="kbd">unordered_set</span> of all used identifiers in the
              <span class="kbd">IcmpSocketFactory</span> for a given node.
            </p>
          </div>
        </li>
      </ul>
    </div>
  </section>

  <!-- Design Note (Problem/Solution) -->
  <section id="problem" class="section">
    <div class="container">
      <h5 class="section-title">Design Note</h5>

      <div class="card">
        <div class="card-content">
          <span class="card-title">Problem: Identifier Management in Protocol Layer</span>
          <p>
            In the current low-level design, the ICMP protocol layer maintains a map of used identifiers. This introduces unnecessary state management into the protocol and couples concerns outside its core function.
          </p>
          <span class="card-title" style="margin-top:16px;">Proposed Solution: Centralize in Socket Factory</span>
          <p>
            Move identifier management to <span class="kbd">IcmpSocketFactory</span>. Maintain an <span class="kbd">unordered_set</span> of active identifiers per node for O(1) lookup and allocation, keeping the protocol layer clean and responsibilities well-separated.
          </p>
        </div>
      </div>
    </div>
  </section>

  <!-- Links -->
  <section id="links" class="section">
    <div class="container">
      <h5 class="section-title">Project Links</h5>
      <ul class="collection">
        <li class="collection-item">
          <i class="material-icons icon-bullet">merge_type</i>
          <a href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests/2486" target="_blank" rel="noopener">MR #2486 — Raw Sockets Fragmentation Fix</a>
        </li>
        <li class="collection-item">
          <i class="material-icons icon-bullet">merge_type</i>
          <a href="https://gitlab.com/nsnam/ns-3-dev/-/merge_requests/2527" target="_blank" rel="noopener">MR #2527 — ICMP Socket Implementation</a>
        </li>
      </ul>
    </div>
  </section>

  <!-- Footer -->
  <footer class="page-footer">
    <div class="container">
      <div class="row" style="margin-bottom:0;">
        <div class="col s12">
          <p>Built with Materialize. Content © Aditya Ruhela.</p>
        </div>
      </div>
    </div>
  </footer>

  <!-- Materialize JS -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/materialize/1.0.0/js/materialize.min.js"></script>
  <script>
    document.addEventListener('DOMContentLoaded', function() {
      M.AutoInit();
    });
  </script>
</body>
</html>
